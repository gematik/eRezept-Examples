{
  "id": "079b2972-0ebe-4939-b081-918045e454f5",
  "mainActor": "Apotheke",
  "name": "Erneutes Dispensieren durch die gleiche Apotheke nicht möglich",
  "tags": [
    "@Workflow=160",
    "@Versicherung=GKV",
    "@Anwendungsfall=A_18827",
    "@Anwendungsfall=A_18502",
    "@Anwendungsfall=A_18503",
    "@Impl=done",
    "@TCID=ERP_EE_WF160_03",
    "@Path=bad",
    "@Afo=A_19232",
    "@Hauptdarsteller=Apotheke"
  ],
  "description": "Die Apotheke kann nach erfolgreicher Dispensierung den Task nicht noch einmal mit einem /Task/<id>/$close-Operation beenden,\n  weil der Task im Status \"completed\" ist.",
  "feature": "Apothekenpflichtige Medikamente für GKV-Versicherte",
  "featureFile": "GKV_WF_160/GKV-Versicherter_WF_160.feature",
  "steps": [
    {
      "name": "Angenommen die Ärztin Dr. Schraßer hat Zugriff auf ihren HBA und auf die SMC-B der Praxis"
    },
    {
      "name": "Und die GKV Versicherte Sina Hüllmann hat Zugriff auf ihre eGK"
    },
    {
      "name": "Und die Apotheke Am Flughafen hat Zugriff auf ihre SMC-B"
    },
    {
      "name": "Und die Apotheke Stadtapotheke hat Zugriff auf ihre SMC-B"
    },
    {
      "name": "Wenn die Ärztin Dr. Schraßer der Versicherten Sina Hüllmann folgendes apothekenpflichtiges Medikament verschreibt:\n| Name | PZN |\n| Schmerzmittel | 12345678 |",
      "dumps": [
        {
          "operation": "POST /Task/$create",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/0_Request_Parameters.xml"
        },
        {
          "operation": "Response 201: Task Task/160.000.040.326.786.39",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/1_Response_Task.xml"
        },
        {
          "operation": "Document to sign with HBA 80276883110000095767 on Soft-Konn",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/2_document_to_sign.xml"
        },
        {
          "operation": "Signed Document with HBA 80276883110000095767 on Soft-Konn",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/3_signed_document.b64"
        },
        {
          "operation": "POST /Task/160.000.040.326.786.39/$activate",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/4_Request_Parameters.xml"
        },
        {
          "operation": "Response 200: Task Task/160.000.040.326.786.39",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/5_Response_Task.xml"
        },
        {
          "operation": "DMC for 160.000.040.326.786.39 with AccessCode 563c6130c7bca3d6bd2c13b4b71ae69f1271e30b1b1379591a55202bf237d06a",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/6_dmc_160.000.040.326.786.39.png"
        }
      ]
    },
    {
      "name": "Und die Versicherte Sina Hüllmann ihr letztes ausgestellte E-Rezept der Apotheke Am Flughafen via Data Matrix Code zuweist"
    },
    {
      "name": "Und die Apotheke Am Flughafen das letzte zugewiesene E-Rezept beim Fachdienst akzeptiert",
      "dumps": [
        {
          "operation": "Response 200: Bundle Bundle/d4f6cef2-9e62-45ba-b6ba-c42647e22f6b",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/7_Response_Bundle.xml"
        }
      ]
    },
    {
      "name": "Und die Apotheke Am Flughafen das letzte akzeptierte E-Rezept korrekt an Sina Hüllmann dispensiert",
      "dumps": [
        {
          "operation": "POST /Task/160.000.040.326.786.39/$close?secret=e6e8bdc924168ab8ea3ecd720075be6842e8518bb94fdd9a3f04341b62bf9eef",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/8_Request_MedicationDispense.xml"
        },
        {
          "operation": "Response 200: Bundle Bundle/a0825667-0200-0000-0003-000000000000",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/9_Response_Bundle.xml"
        }
      ]
    },
    {
      "name": "Dann kann die Apotheke Am Flughafen das letzte dispensierte E-Rezept nicht erneut dispensieren"
    },
    {
      "name": "Am flughafen check the return code",
      "dumps": [
        {
          "operation": "POST /Task/160.000.040.326.786.39/$close?secret=e6e8bdc924168ab8ea3ecd720075be6842e8518bb94fdd9a3f04341b62bf9eef",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/10_Request_MedicationDispense.xml"
        },
        {
          "operation": "Response 403: OperationOutcome 20230418_083724",
          "file": "Apotheke/erneutes_dispensieren_durch_die_gleiche_apotheke_nicht_möglich/11_Response_OperationOutcome.xml"
        }
      ]
    },
    {
      "name": "Am flughafen performable predicate"
    }
  ],
  "requirements": ["A_19232"],
  "useCases": ["A_18827", "A_18502", "A_18503"]
}
